"use strict";(self.webpackChunkclinica=self.webpackChunkclinica||[]).push([[574],{2574:(w,u,s)=>{s.r(u),s.d(u,{SolicitarTurnoModule:()=>F});var p=s(8583),d=s(7202),n=s(639),g=s(5058),h=s(9726),c=s(665);function m(o,a){if(1&o){const i=n.EpF();n.ynx(0),n.TgZ(1,"div",8),n.TgZ(2,"input",9),n.NdJ("ngModelChange",function(t){return n.CHM(i),n.oxw(3).paciente=t}),n.qZA(),n.TgZ(3,"label",10),n._uU(4),n.qZA(),n.qZA(),n.BQk()}if(2&o){const i=n.oxw().$implicit,e=n.oxw(2);n.xp6(2),n.Q6J("ngModel",e.paciente)("value",i)("id",i.uid),n.xp6(1),n.Q6J("for",i.uid),n.xp6(1),n.hij(" ",i.nombre," ")}}function f(o,a){if(1&o&&(n.ynx(0),n.YNc(1,m,5,5,"ng-container",3),n.BQk()),2&o){const i=a.$implicit;n.xp6(1),n.Q6J("ngIf",i.uid)}}function T(o,a){if(1&o&&(n.ynx(0),n.TgZ(1,"h5",4),n._uU(2,"Paciente"),n.qZA(),n.YNc(3,f,2,1,"ng-container",7),n.BQk()),2&o){const i=n.oxw();n.xp6(3),n.Q6J("ngForOf",i.pacientes)}}function x(o,a){if(1&o){const i=n.EpF();n.TgZ(0,"div",8),n.TgZ(1,"input",11),n.NdJ("change",function(){return n.CHM(i),n.oxw().getHorarios()})("ngModelChange",function(t){return n.CHM(i),n.oxw().especialidad=t}),n.qZA(),n.TgZ(2,"label",10),n._uU(3),n.qZA(),n.qZA()}if(2&o){const i=a.$implicit,e=n.oxw();n.xp6(1),n.Q6J("ngModel",e.especialidad)("value",i)("id",i.nombre),n.xp6(1),n.Q6J("for",i.nombre),n.xp6(1),n.hij(" ",i.nombre," ")}}function S(o,a){if(1&o){const i=n.EpF();n.ynx(0),n.TgZ(1,"div",8),n.TgZ(2,"input",12),n.NdJ("change",function(){return n.CHM(i),n.oxw(3).getHorarios()})("ngModelChange",function(t){return n.CHM(i),n.oxw(3).especialista=t}),n.qZA(),n.TgZ(3,"label",10),n._uU(4),n.qZA(),n.qZA(),n.BQk()}if(2&o){const i=n.oxw().$implicit,e=n.oxw(2);n.xp6(2),n.Q6J("ngModel",e.especialista)("value",i)("id",i.uid),n.xp6(1),n.Q6J("for",i.uid),n.xp6(1),n.hij(" ",i.nombre," ")}}function Z(o,a){if(1&o&&(n.ynx(0),n.YNc(1,S,5,5,"ng-container",3),n.BQk()),2&o){const i=a.$implicit;n.xp6(1),n.Q6J("ngIf",i.uid)}}function v(o,a){if(1&o&&(n.ynx(0),n.TgZ(1,"h5",4),n._uU(2,"Especialista"),n.qZA(),n.YNc(3,Z,2,1,"ng-container",7),n.BQk()),2&o){const i=n.oxw();n.xp6(3),n.Q6J("ngForOf",i.especialistas)}}function C(o,a){if(1&o&&(n.TgZ(0,"option",16),n._uU(1),n.qZA()),2&o){const i=a.$implicit,e=n.oxw(2);n.Q6J("value",i.toISOString().split("T")[0])("disabled",0==i.getDay()),n.xp6(1),n.AsE("",i.toLocaleString().split(",")[0]," - ",e.nombreDias[i.getDay()],"")}}function b(o,a){if(1&o){const i=n.EpF();n.ynx(0),n.TgZ(1,"h5",4),n._uU(2,"Fecha"),n.qZA(),n.TgZ(3,"p"),n.TgZ(4,"i"),n._uU(5,"Domingos no habilitados"),n.qZA(),n.qZA(),n.TgZ(6,"select",13),n.NdJ("change",function(){return n.CHM(i),n.oxw().getHorarios()})("ngModelChange",function(t){return n.CHM(i),n.oxw().fecha=t}),n.TgZ(7,"option",14),n._uU(8,"Seleccionar fecha"),n.qZA(),n.YNc(9,C,2,4,"option",15),n.qZA(),n.BQk()}if(2&o){const i=n.oxw();n.xp6(6),n.Q6J("ngModel",i.fecha),n.xp6(3),n.Q6J("ngForOf",i.dias)}}function M(o,a){if(1&o&&(n.TgZ(0,"option",19),n._uU(1),n.qZA()),2&o){const i=a.$implicit;n.Q6J("value",i),n.xp6(1),n.Oqu(i)}}function A(o,a){if(1&o){const i=n.EpF();n.ynx(0),n.TgZ(1,"h5",4),n._uU(2,"Horarios disponibles"),n.qZA(),n.TgZ(3,"select",17),n.NdJ("ngModelChange",function(t){return n.CHM(i),n.oxw().hora=t}),n.TgZ(4,"option",14),n._uU(5,"Seleccionar hora"),n.qZA(),n.YNc(6,M,2,2,"option",18),n.qZA(),n.BQk()}if(2&o){const i=n.oxw();n.xp6(3),n.Q6J("ngModel",i.hora),n.xp6(3),n.Q6J("ngForOf",i.horasDisponibles)}}function J(o,a){if(1&o){const i=n.EpF();n.TgZ(0,"button",20),n.NdJ("click",function(){return n.CHM(i),n.oxw().solicitarTurno()}),n._uU(1," Solicitar "),n.qZA()}}const Q=[{path:"",component:(()=>{class o{constructor(i,e){this.authService=i,this.storeService=e,this.that=this,this.nombreDias=["Domingo","Lunes","Martes","Miercoles","Jueves","Viernes","Sabado"],this.dias=[],this.especialidades=this.storeService.GetEspecialidades(),this.storeService.GetUsuarios().subscribe(t=>{this.especialistas=t.filter(r=>"especialista"===r.rol)})}getHorarios(){if(!this.fecha||!this.especialidad.nombre)return;this.getHorasDisponibles();const i=this.storeService.GetTurnos({especialidad:this.especialidad,especialista:this.especialista,fecha:this.fecha});this.horasDisponibles=this.horas.filter(e=>!i||!i.find(t=>t.hora===e)),this.hora=""}solicitarTurno(i){let e=this;i&&(e=i);let t=e.authService.getUser;e.authService.isValidAdmin&&(t=e.paciente,!t)||e.storeService.CreateTurno({paciente:t,especialidad:e.especialidad,especialista:e.especialista,estado:"pendiente",fecha:e.fecha,hora:e.hora})}formatNumb(i){return i<10?`0${i}`:i}addDays(i,e){const t=new Date(i);return t.setDate(t.getDate()+e),t}getHorasDisponibles(){var i,e;this.horas=[];const t=new Date(this.fecha);let r=11;if(0===t.getDate())return;6===t.getDay()&&(r=6);const l=this.especialista.especialidad.find(_=>_.nombre===this.especialidad.nombre);if(6===r){if(null===(i=null==l?void 0:l.disponibilidadSabado)||void 0===i?void 0:i.length)return void(this.horas=l.disponibilidadSabado.sort())}else if(null===(e=null==l?void 0:l.disponibilidadSemana)||void 0===e?void 0:e.length)return void(this.horas=l.disponibilidadSemana.sort());for(let _=0;_<60*r;_+=this.especialidad.duracionTurno){const q=this.formatNumb(_%60),N=this.formatNumb(8+Math.floor(_/60));this.horas=[...this.horas,`${N}:${q}hs`]}}ngOnInit(){const i=new Date;for(let e=0;e<15;e++)this.dias.push(this.addDays(i,e));this.authService.isValidAdmin&&this.storeService.GetUsuarios().subscribe(e=>{this.pacientes=e.filter(t=>"paciente"===t.rol)})}}return o.\u0275fac=function(i){return new(i||o)(n.Y36(g.e),n.Y36(h.TM))},o.\u0275cmp=n.Xpm({type:o,selectors:[["app-solicitar-turno"]],decls:15,vars:8,consts:[[1,"row"],[1,"col-12"],[1,"col-6","mb-3"],[4,"ngIf"],[1,"mt-3"],["class","form-check",4,"ngFor","ngForOf"],["class","btn btn-primary mt-3",3,"click",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"form-check"],["type","radio","name","paciente",1,"form-check-input",3,"ngModel","value","id","ngModelChange"],[1,"form-check-label",3,"for"],["type","radio","name","especialidad",1,"form-check-input",3,"ngModel","value","id","change","ngModelChange"],["type","radio","name","especialista",1,"form-check-input",3,"ngModel","value","id","change","ngModelChange"],["name","hora","id","",3,"ngModel","change","ngModelChange"],["value","","disabled",""],[3,"value","disabled",4,"ngFor","ngForOf"],[3,"value","disabled"],["name","hora","id","",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"btn","btn-primary","mt-3",3,"click"]],template:function(i,e){1&i&&(n.TgZ(0,"div",0),n.TgZ(1,"div",1),n.TgZ(2,"h2"),n._uU(3,"Solicitar turno"),n.qZA(),n.qZA(),n.TgZ(4,"div",2),n.YNc(5,T,4,1,"ng-container",3),n.TgZ(6,"h5",4),n._uU(7,"Especialidad"),n.qZA(),n.YNc(8,x,4,5,"div",5),n.ALo(9,"async"),n.YNc(10,v,4,1,"ng-container",3),n.YNc(11,b,10,2,"ng-container",3),n.YNc(12,A,7,2,"ng-container",3),n.TgZ(13,"div"),n.YNc(14,J,2,0,"button",6),n.qZA(),n.qZA(),n.qZA()),2&i&&(n.xp6(5),n.Q6J("ngIf",e.pacientes),n.xp6(3),n.Q6J("ngForOf",n.lcZ(9,6,e.especialidades)),n.xp6(2),n.Q6J("ngIf",e.especialidad),n.xp6(1),n.Q6J("ngIf",e.especialista),n.xp6(1),n.Q6J("ngIf",e.fecha&&e.horasDisponibles),n.xp6(2),n.Q6J("ngIf",e.hora))},directives:[p.O5,p.sg,c._,c.Fj,c.JJ,c.On,c.EJ,c.YN,c.Kr],pipes:[p.Ov],styles:[""]}),o})()}];let y=(()=>{class o{}return o.\u0275fac=function(i){return new(i||o)},o.\u0275mod=n.oAB({type:o}),o.\u0275inj=n.cJS({imports:[[d.Bz.forChild(Q)],d.Bz]}),o})(),F=(()=>{class o{}return o.\u0275fac=function(i){return new(i||o)},o.\u0275mod=n.oAB({type:o}),o.\u0275inj=n.cJS({imports:[[p.ez,c.u5,c.UX,y]]}),o})()}}]);