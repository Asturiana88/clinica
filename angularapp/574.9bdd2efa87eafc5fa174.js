"use strict";(self.webpackChunkclinica=self.webpackChunkclinica||[]).push([[574],{2574:(D,d,c)=>{c.r(d),c.d(d,{SolicitarTurnoModule:()=>N});var u=c(8583),_=c(8093),g=c(4762),n=c(639),h=c(5058),m=c(9726),s=c(3679);function f(e,a){if(1&e){const i=n.EpF();n.ynx(0),n.TgZ(1,"div",8),n.TgZ(2,"input",9),n.NdJ("ngModelChange",function(o){return n.CHM(i),n.oxw(3).paciente=o}),n.qZA(),n.TgZ(3,"label",10),n._uU(4),n.qZA(),n.qZA(),n.BQk()}if(2&e){const i=n.oxw().$implicit,t=n.oxw(2);n.xp6(2),n.Q6J("ngModel",t.paciente)("value",i)("id",i.uid),n.xp6(1),n.Q6J("for",i.uid),n.xp6(1),n.hij(" ",i.nombre," ")}}function T(e,a){if(1&e&&(n.ynx(0),n.YNc(1,f,5,5,"ng-container",3),n.BQk()),2&e){const i=a.$implicit;n.xp6(1),n.Q6J("ngIf",i.uid)}}function x(e,a){if(1&e&&(n.ynx(0),n.TgZ(1,"h5",4),n._uU(2,"Paciente"),n.qZA(),n.YNc(3,T,2,1,"ng-container",7),n.BQk()),2&e){const i=n.oxw();n.xp6(3),n.Q6J("ngForOf",i.pacientes)}}function v(e,a){if(1&e){const i=n.EpF();n.TgZ(0,"div",8),n.TgZ(1,"input",11),n.NdJ("change",function(){return n.CHM(i),n.oxw().updateEspecialistas()})("ngModelChange",function(o){return n.CHM(i),n.oxw().especialidad=o}),n.qZA(),n.TgZ(2,"label",10),n._uU(3),n.qZA(),n.qZA()}if(2&e){const i=a.$implicit,t=n.oxw();n.xp6(1),n.Q6J("ngModel",t.especialidad)("value",i)("id",i.nombre),n.xp6(1),n.Q6J("for",i.nombre),n.xp6(1),n.hij(" ",i.nombre," ")}}function S(e,a){if(1&e){const i=n.EpF();n.ynx(0),n.TgZ(1,"div",8),n.TgZ(2,"input",12),n.NdJ("change",function(){return n.CHM(i),n.oxw(3).getHorarios()})("ngModelChange",function(o){return n.CHM(i),n.oxw(3).especialista=o}),n.qZA(),n.TgZ(3,"label",10),n._uU(4),n.qZA(),n.qZA(),n.BQk()}if(2&e){const i=n.oxw().$implicit,t=n.oxw(2);n.xp6(2),n.Q6J("ngModel",t.especialista)("value",i)("id",i.uid),n.xp6(1),n.Q6J("for",i.uid),n.xp6(1),n.hij(" ",i.nombre," ")}}function Z(e,a){if(1&e&&(n.ynx(0),n.YNc(1,S,5,5,"ng-container",3),n.BQk()),2&e){const i=a.$implicit;n.xp6(1),n.Q6J("ngIf",i.uid)}}function C(e,a){if(1&e&&(n.ynx(0),n.TgZ(1,"h5",4),n._uU(2,"Especialista"),n.qZA(),n.YNc(3,Z,2,1,"ng-container",7),n.BQk()),2&e){const i=n.oxw();n.xp6(3),n.Q6J("ngForOf",i.especialistas)}}function b(e,a){if(1&e&&(n.TgZ(0,"option",16),n._uU(1),n.qZA()),2&e){const i=a.$implicit,t=n.oxw(2);n.Q6J("value",i.toISOString().split("T")[0])("disabled",0==i.getDay()),n.xp6(1),n.AsE("",i.toLocaleString().split(",")[0]," - ",t.nombreDias[i.getDay()],"")}}function M(e,a){if(1&e){const i=n.EpF();n.ynx(0),n.TgZ(1,"h5",4),n._uU(2,"Fecha"),n.qZA(),n.TgZ(3,"p"),n.TgZ(4,"i"),n._uU(5,"Domingos no habilitados"),n.qZA(),n.qZA(),n.TgZ(6,"select",13),n.NdJ("change",function(){return n.CHM(i),n.oxw().getHorarios()})("ngModelChange",function(o){return n.CHM(i),n.oxw().fecha=o}),n.TgZ(7,"option",14),n._uU(8,"Seleccionar fecha"),n.qZA(),n.YNc(9,b,2,4,"option",15),n.qZA(),n.BQk()}if(2&e){const i=n.oxw();n.xp6(6),n.Q6J("ngModel",i.fecha),n.xp6(3),n.Q6J("ngForOf",i.dias)}}function A(e,a){if(1&e&&(n.TgZ(0,"option",19),n._uU(1),n.qZA()),2&e){const i=a.$implicit;n.Q6J("value",i),n.xp6(1),n.Oqu(i)}}function J(e,a){if(1&e){const i=n.EpF();n.ynx(0),n.TgZ(1,"h5",4),n._uU(2,"Horarios disponibles"),n.qZA(),n.TgZ(3,"select",17),n.NdJ("ngModelChange",function(o){return n.CHM(i),n.oxw().hora=o}),n.TgZ(4,"option",14),n._uU(5,"Seleccionar hora"),n.qZA(),n.YNc(6,A,2,2,"option",18),n.qZA(),n.BQk()}if(2&e){const i=n.oxw();n.xp6(3),n.Q6J("ngModel",i.hora),n.xp6(3),n.Q6J("ngForOf",i.horasDisponibles)}}function Q(e,a){if(1&e){const i=n.EpF();n.TgZ(0,"button",20),n.NdJ("click",function(){return n.CHM(i),n.oxw().solicitarTurno()}),n._uU(1," Solicitar "),n.qZA()}}const y=[{path:"",component:(()=>{class e{constructor(i,t){this.authService=i,this.storeService=t,this.that=this,this.nombreDias=["Domingo","Lunes","Martes","Miercoles","Jueves","Viernes","Sabado"],this.dias=[],this.especialidades=this.storeService.GetEspecialidades(),this.storeService.GetUsuarios().subscribe(o=>{this.especialistas=o.filter(r=>"especialista"===r.rol),this.especialistasFilter=[...this.especialistas]})}updateEspecialistas(){this.especialistas=this.especialistasFilter.filter(i=>i.especialidad&&i.especialidad.find(t=>t.nombre===this.especialidad.nombre)),this.getHorarios()}getHorarios(){return(0,g.mG)(this,void 0,void 0,function*(){if(!this.fecha||!this.especialidad.nombre)return;this.getHorasDisponibles();const i=yield this.storeService.GetTurnos({especialidad:this.especialidad,especialista:this.especialista,fecha:this.fecha});this.horasDisponibles=this.horas.filter(t=>!i||!i.find(o=>o.hora===t)),this.hora=""})}solicitarTurno(i){let t=this;i&&(t=i);let o=t.authService.getUser;t.authService.isValidAdmin&&(o=t.paciente,!o)||t.storeService.CreateTurno({paciente:o,especialidad:t.especialidad,especialista:t.especialista,estado:"pendiente",fecha:t.fecha,hora:t.hora})}formatNumb(i){return i<10?`0${i}`:i}addDays(i,t){const o=new Date(i);return o.setDate(o.getDate()+t),o}getHorasDisponibles(){var i,t;this.horas=[];const o=new Date(this.fecha);let r=11;if(0===o.getDate())return;6===o.getDay()&&(r=6);const l=this.especialista.especialidad&&this.especialista.especialidad.find(p=>p.nombre===this.especialidad.nombre);if(6===r){if(null===(i=null==l?void 0:l.disponibilidadSabado)||void 0===i?void 0:i.length)return void(this.horas=l.disponibilidadSabado.sort())}else if(null===(t=null==l?void 0:l.disponibilidadSemana)||void 0===t?void 0:t.length)return void(this.horas=l.disponibilidadSemana.sort());for(let p=0;p<60*r;p+=this.especialidad.duracionTurno){const q=this.formatNumb(p%60),w=this.formatNumb(8+Math.floor(p/60));this.horas=[...this.horas,`${w}:${q}hs`]}}ngOnInit(){const i=new Date;for(let t=0;t<15;t++)this.dias.push(this.addDays(i,t));this.authService.isValidAdmin&&this.storeService.GetUsuarios().subscribe(t=>{this.pacientes=t.filter(o=>"paciente"===o.rol)})}}return e.\u0275fac=function(i){return new(i||e)(n.Y36(h.e),n.Y36(m.TM))},e.\u0275cmp=n.Xpm({type:e,selectors:[["app-solicitar-turno"]],decls:15,vars:8,consts:[[1,"row"],[1,"col-12"],[1,"col-6","mb-3"],[4,"ngIf"],[1,"mt-3"],["class","form-check",4,"ngFor","ngForOf"],["class","btn btn-primary mt-3",3,"click",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"form-check"],["type","radio","name","paciente",1,"form-check-input",3,"ngModel","value","id","ngModelChange"],[1,"form-check-label",3,"for"],["type","radio","name","especialidad",1,"form-check-input",3,"ngModel","value","id","change","ngModelChange"],["type","radio","name","especialista",1,"form-check-input",3,"ngModel","value","id","change","ngModelChange"],["name","hora","id","",3,"ngModel","change","ngModelChange"],["value","","disabled",""],[3,"value","disabled",4,"ngFor","ngForOf"],[3,"value","disabled"],["name","hora","id","",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"btn","btn-primary","mt-3",3,"click"]],template:function(i,t){1&i&&(n.TgZ(0,"div",0),n.TgZ(1,"div",1),n.TgZ(2,"h2"),n._uU(3,"Solicitar turno"),n.qZA(),n.qZA(),n.TgZ(4,"div",2),n.YNc(5,x,4,1,"ng-container",3),n.TgZ(6,"h5",4),n._uU(7,"Especialidad"),n.qZA(),n.YNc(8,v,4,5,"div",5),n.ALo(9,"async"),n.YNc(10,C,4,1,"ng-container",3),n.YNc(11,M,10,2,"ng-container",3),n.YNc(12,J,7,2,"ng-container",3),n.TgZ(13,"div"),n.YNc(14,Q,2,0,"button",6),n.qZA(),n.qZA(),n.qZA()),2&i&&(n.xp6(5),n.Q6J("ngIf",t.pacientes),n.xp6(3),n.Q6J("ngForOf",n.lcZ(9,6,t.especialidades)),n.xp6(2),n.Q6J("ngIf",t.especialidad),n.xp6(1),n.Q6J("ngIf",t.especialista),n.xp6(1),n.Q6J("ngIf",t.fecha&&t.horasDisponibles),n.xp6(2),n.Q6J("ngIf",t.hora))},directives:[u.O5,u.sg,s._,s.Fj,s.JJ,s.On,s.EJ,s.YN,s.Kr],pipes:[u.Ov],styles:[""]}),e})()}];let F=(()=>{class e{}return e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=n.oAB({type:e}),e.\u0275inj=n.cJS({imports:[[_.Bz.forChild(y)],_.Bz]}),e})(),N=(()=>{class e{}return e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=n.oAB({type:e}),e.\u0275inj=n.cJS({imports:[[u.ez,s.u5,s.UX,F]]}),e})()}}]);